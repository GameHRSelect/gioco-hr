<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <title>Test Interattivo HR – Profilo Psicologico</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- Impostazioni di stile con palette Selèct -->
  <style>
    :root {
      --bg-light: #F1E5D7;
      --dark-magenta: #8D064A;
      --dark-blue: #06283F;
      --blue: #1B65A5;
      --red: #D80D32;
      --light-blue: #4AAFD8;
      --hist-a: var(--dark-magenta);
      --hist-b: var(--blue);
      --hist-c: var(--red);
    }
    /* Reset e box model */
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: 'Georgia', serif;
      background-color: var(--bg-light);
      color: var(--dark-blue);
      padding: 20px;
      display: flex;
      justify-content: center;
    }
    .container {
      width: 100%;
      max-width: 960px;
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 4px 16px rgba(0,0,0,0.1);
      overflow: hidden;
    }
    header {
      background: var(--blue);
      color: #fff;
      padding: 20px;
      text-align: center;
    }
    header h1 { font-size: 2rem; }
    .progress-container { background: #eee; height: 8px; }
    .progress-bar { height: 100%; width: 0; background: var(--light-blue); transition: width 0.4s ease; }
    .body-content { padding: 24px; }
    .question-container { margin-bottom: 24px; }
    .answers h3 { font-size: 1.4rem; margin-bottom: 16px; color: var(--dark-magenta); }
    .answers label { display: block; margin-bottom: 12px; padding: 12px; border: 2px solid var(--blue); border-radius: 6px; cursor: pointer; transition: background 0.2s; }
    .answers input { margin-right: 10px; }
    .answers label:hover { background: var(--bg-light); }
    .navigation { text-align: right; margin-top: 16px; }
    .navigation button { margin-left: 10px; padding: 10px 20px; border: none; border-radius: 6px; background: var(--dark-magenta); color: #fff; cursor: pointer; transition: background 0.2s; }
    .navigation button:disabled { background: #ccc; cursor: not-allowed; }
    .navigation button:not(:disabled):hover { background: var(--red); }
    #result { padding: 24px; animation: fadeIn 0.5s ease; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(20px);} to { opacity: 1; transform: translateY(0);} }
    #result h2 { color: var(--blue); margin-bottom: 16px; }
    #result p { margin-bottom: 16px; text-align: justify; }
    #histogram { max-width: 600px; margin: 24px auto; }
    table { width: 100%; border-collapse: collapse; margin-top: 16px; }
    th, td { border: 1px solid var(--light-blue); padding: 10px; text-align: center; }
    th { background: var(--dark-blue); color: #fff; }
    tr:nth-child(even) { background: var(--bg-light); }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>Test Interattivo HR</h1>
      <div class="progress-container"><div class="progress-bar" id="progressBar"></div></div>
    </header>
    <div class="body-content">
      <div id="quiz"></div>
    </div>
  </div>

  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
  (function() {
    'use strict';

    // Configurazione domande
    const questions = [
      { text: 'Quando un collaboratore mostra segni di disimpegno, come reagisce?', answers: ['Offro coaching individuale', 'Rivedo obiettivi e KPI', 'Analizzo processi organizzativi'] },
      { text: 'Quale caratteristica ritiene più influente per un leader efficace?', answers: ['Empatia e ascolto', 'Visione strategica', 'Adattamento e resilienza'] },
      { text: 'In caso di conflitto tra membri del team, quale approccio utilizza?', answers: ['Mediazione emotiva', 'Procedure formali', 'Analisi culturale'] },
      { text: 'Come gestisce la selezione dei candidati per posizioni chiave?', answers: ['Fit culturale', 'Competenze e potenziale', 'Compatibilità processi'] },
      { text: 'Qual è la sua strategia per motivare il personale?', answers: ['Feedback continuo', 'Carriera strutturata', 'Ottimizzazione ambienti'] },
      { text: 'Quando definisce il ruolo di un collaboratore, cosa considera prioritario?', answers: ['Aspirazioni personali', 'Mission aziendale', 'Efficienza operativa'] },
      { text: 'Come approccia la formazione continua in azienda?', answers: ['Formazione personalizzata', 'Programmi certificati', 'E-learning flessibile'] }
    ];

    let current = 0;
    const responses = [];

    // Utility per creare elementi
    function createElement(tag, props, ...children) {
      const el = document.createElement(tag);
      Object.keys(props || {}).forEach(key => el[key] = props[key]);
      children.forEach(child => {
        if (typeof child === 'string') el.appendChild(document.createTextNode(child));
        else el.appendChild(child);
      });
      return el;
    }

    function updateProgress() {
      const bar = document.getElementById('progressBar');
      bar.style.width = ((current) / questions.length * 100) + '%';
    }

    function renderQuestion() {
      updateProgress();
      const container = document.getElementById('quiz');
      container.innerHTML = '';
      const q = questions[current];

      // Domanda
      const qDiv = createElement('div', { className: 'question-container' });
      const title = createElement('h3', {}, `Domanda ${current+1}/${questions.length}: `, q.text);
      qDiv.appendChild(title);

      // Risposte
      const answersDiv = createElement('div', { className: 'answers' });
      q.answers.forEach((ans, i) => {
        const id = `q${current}a${i}`;
        const radio = createElement('input', { type: 'radio', name: 'answer', id, value: ['A','B','C'][i] });
        radio.addEventListener('change', () => {
          responses[current] = radio.value;
          document.getElementById('nextBtn').disabled = false;
        });
        const label = createElement('label', { htmlFor: id }, radio, ans);
        answersDiv.appendChild(label);
      });

      // Navigazione
      const navDiv = createElement('div', { className: 'navigation' });
      const prevBtn = createElement('button', { disabled: current===0 }, 'Indietro');
      prevBtn.addEventListener('click', () => { saveResponse(); current--; renderQuestion(); });
      const nextBtn = createElement('button', { id: 'nextBtn', disabled: !responses[current] }, current === questions.length-1 ? 'Vedi Profilo' : 'Avanti');
      nextBtn.addEventListener('click', () => { saveResponse(); current++; renderQuestion(); });
      navDiv.appendChild(prevBtn);
      navDiv.appendChild(nextBtn);

      qDiv.appendChild(answersDiv);
      qDiv.appendChild(navDiv);
      container.appendChild(qDiv);
    }

    function saveResponse() {
      const sel = document.querySelector('input[name="answer"]:checked');
      if (sel) responses[current] = sel.value;
    }

    function showResult() {
      updateProgress();
      const container = document.getElementById('quiz');
      container.innerHTML = '';

      // Contiamo risposte
      const counts = { A:0, B:0, C:0 };
      responses.forEach(r => counts[r]++);

      const total = questions.length;
      const resDiv = createElement('div', { id: 'result' });
      const header = createElement('h2', {}, 'Profilo Psicologico HR');
      resDiv.appendChild(header);

      // Costruzione narrativa
      const maxCount = Math.max(counts.A, counts.B, counts.C);
      const dominant = Object.keys(counts).filter(k => counts[k] === maxCount)[0];
      let narrative;
      switch (dominant) {
        case 'A': narrative = 'Sei guidato dall’immagine: cerchi nel gruppo un riflesso di te stesso e trasformi ogni relazione in specchio.'; break;
        case 'B': narrative = 'Vivi nel simbolo e nella parola: ordini e significati scandiscono ogni tuo passo organizzativo.'; break;
        case 'C': narrative = 'Abiti il non detto: il tuo potere nasce dall’inafferrabile, creando innovazione nel vuoto.'; break;
      }
      resDiv.appendChild(createElement('p', { innerHTML: `<strong>Narrativa:</strong> ${narrative}` }));

      // Istogramma
      const canvas = createElement('canvas', { id: 'histogram' });
      resDiv.appendChild(canvas);

      // Tabella
      const table = createElement('table', {});
      table.innerHTML = `<thead><tr><th>Risposta</th><th>Conteggio</th><th>%</th></tr></thead>` +
        `<tbody>` +
        `<tr><td>A</td><td>${counts.A}</td><td>${((counts.A/total)*100).toFixed(1)}%</td></tr>` +
        `<tr><td>B</td><td>${counts.B}</td><td>${((counts.B/total)*100).toFixed(1)}%</td></tr>` +
        `<tr><td>C</td><td>${counts.C}</td><td>${((counts.C/total)*100).toFixed(1)}%</td></tr>` +
        `</tbody>`;
      resDiv.appendChild(table);
      container.appendChild(resDiv);

      // Render grafico
      new Chart(canvas.getContext('2d'), {
        type: 'bar',
        data: {
          labels: ['A','B','C'],
          datasets: [{
            data: [counts.A, counts.B, counts.C],
            backgroundColor: ['var(--hist-a)','var(--hist-b)','var(--hist-c)']
          }]
        },
        options: { scales: { y: { beginAtZero: true, stepSize: 1 } }, plugins: { legend: { display: false } } }
      });
    }

    document.addEventListener('DOMContentLoaded', renderQuestion);
  })();
  </script>
</body>
</html>
