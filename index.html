<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <title>Test Interattivo HR – Profilo Psicologico</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    :root {
      /* Palette Selèct */
      --bg-light: #F1E5D7;
      --dark-magenta: #8D064A;
      --dark-blue: #06283F;
      --blue: #1B65A5;
      --red: #D80D32;
      --light-blue: #4AAFD8;
      --hist-a: var(--dark-magenta);
      --hist-b: var(--blue);
      --hist-c: var(--red);
    }
    body {
      font-family: 'Georgia', serif;
      background-color: var(--bg-light);
      margin: 0;
      padding: 0;
      color: var(--dark-blue);
      line-height: 1.5;
    }
    .container {
      max-width: 900px;
      margin: 40px auto;
      background: #fff;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      border-radius: 10px;
      overflow: hidden;
    }
    .question-container {
      display: grid;
      grid-template-columns: 1fr 2fr;
      gap: 20px;
      padding: 25px;
      border-bottom: 2px solid var(--light-blue);
    }
    .question-image {
      width: 100%;
      border-radius: 8px;
      border: 2px solid var(--blue);
    }
    .answers h3 {
      margin-bottom: 15px;
      color: var(--dark-magenta);
      font-size: 1.25rem;
    }
    .answers label {
      display: block;
      margin-bottom: 12px;
      padding: 14px;
      border: 2px solid var(--blue);
      border-radius: 6px;
      background: #fff;
      cursor: pointer;
      transition: background 0.2s, border-color 0.2s;
      font-size: 1rem;
    }
    .answers input {
      margin-right: 10px;
    }
    .answers label:hover {
      background: var(--bg-light);
      border-color: var(--light-blue);
    }
    .answers input:checked + span,
    .answers input:checked ~ label {
      border-color: var(--dark-magenta);
      background: var(--light-blue);
    }
    .navigation {
      text-align: right;
      padding: 0 25px 25px;
    }
    .navigation button {
      background: var(--dark-magenta);
      color: #fff;
      border: none;
      padding: 12px 18px;
      border-radius: 6px;
      font-size: 1rem;
      cursor: pointer;
      margin-left: 10px;
      transition: background 0.2s;
    }
    .navigation button:hover:not(:disabled) {
      background: var(--red);
    }
    button:disabled {
      background: #ccc;
      cursor: default;
    }
    #result {
      padding: 30px;
    }
    #result h2 {
      font-size: 1.8rem;
      margin-bottom: 20px;
      color: var(--blue);
    }
    #result p {
      margin-bottom: 16px;
    }
    #histogram {
      display: block;
      margin: 30px auto;
      max-width: 600px;
    }
    #frequency-grid {
      width: 100%;
      border-collapse: collapse;
      margin: 20px 0;
    }
    #frequency-grid th,
    #frequency-grid td {
      border: 1px solid var(--light-blue);
      padding: 12px;
      text-align: center;
    }
    #frequency-grid th {
      background: var(--dark-blue);
      color: #fff;
    }
    #frequency-grid tr:nth-child(even) {
      background: var(--bg-light);
    }
  </style>
</head>
<body>
  <div class="container">
    <div id="quiz"></div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
    const questions = [ /* ... array delle 7 domande ... */ ];
    let current = 0;
    const responses = [];

    function renderQuestion() {
      const quiz = document.getElementById('quiz');
      quiz.innerHTML = '';

      if (current < questions.length) {
        const container = document.createElement('div');
        container.className = 'question-container';

        const img = document.createElement('img');
        img.src = questions[current].img;
        img.alt = `Domanda ${current + 1}`;
        img.className = 'question-image';
        container.appendChild(img);

        const right = document.createElement('div');
        right.className = 'answers';
        const qText = document.createElement('h3');
        qText.textContent = `Domanda ${current + 1}: ${questions[current].text}`;
        right.appendChild(qText);

        questions[current].answers.forEach((ans, idx) => {
          const label = document.createElement('label');
          const radio = document.createElement('input');
          radio.type = 'radio';
          radio.name = 'answer';
          radio.value = ['A','B','C'][idx];
          label.appendChild(radio);
          const span = document.createElement('span');
          span.textContent = ans;
          label.appendChild(span);
          right.appendChild(label);
        });

        const nav = document.createElement('div');
        nav.className = 'navigation';
        const btnPrev = document.createElement('button');
        btnPrev.textContent = 'Indietro';
        btnPrev.disabled = current === 0;
        btnPrev.onclick = () => { saveResponse(); current--; renderQuestion(); };
        const btnNext = document.createElement('button');
        btnNext.textContent = current === questions.length - 1 ? 'Vedi Profilo' : 'Avanti';
        btnNext.disabled = !responses[current];
        btnNext.onclick = () => { saveResponse(); current++; renderQuestion(); };
        nav.appendChild(btnPrev);
        nav.appendChild(btnNext);
        right.appendChild(nav);

        right.querySelectorAll('input[name="answer"]').forEach(r => {
          r.onchange = () => { responses[current] = r.value; btnNext.disabled = false; };
        });

        container.appendChild(right);
        quiz.appendChild(container);
      } else {
        showResult();
      }
    }

    function saveResponse() {
      const sel = document.querySelector('input[name="answer"]:checked');
      if (sel) responses[current] = sel.value;
    }

    function showResult() {
      const quiz = document.getElementById('quiz');
      quiz.innerHTML = '';
      const counts = { A:0, B:0, C:0 };
      responses.forEach(r => counts[r]++);
      const total = questions.length;

      const resDiv = document.createElement('div');
      resDiv.id = 'result';

      const title = document.createElement('h2');
      title.textContent = 'Profilo Psicologico HR';
      resDiv.appendChild(title);

      // Testo narrativo e fluido, evocazione lacaniana senza nominarlo
      let narrative = '';
      const maxCount = Math.max(counts.A, counts.B, counts.C);
      const axis = Object.entries(counts).filter(([_, v]) => v === maxCount).map(([k]) => k);

      if (axis.length === 1) {
        if (axis[0] === 'A') {
          narrative = `Il suo sguardo si posa sul riflesso di sé nell’altro, come se ogni gesto fosse un’eco del desiderio che pulsa sotto la superficie. In questo racconto interno, la figura del capo non impone ordini ma si specchia nelle aspettative, trasformando l’ambiente di lavoro in uno specchio mobile in cui si cerca sempre un senso di riconoscimento.`;
        } else if (axis[0] === 'B') {
          narrative = `La sua mente architetta simboli e strutture, intesse trame di presenza e di regole, dove ogni protocollo diventa narrazione di potere e responsabilità. In questo universo il significante guida le azioni, e l’anima dell’organizzazione si rivela attraverso un linguaggio segreto fatto di obiettivi e gerarchie.`;
        } else {
          narrative = `Nel silenzio delle pratiche quotidiane si annida un nucleo oscuro: ciò che sfugge alle parole, l’imprevisto e la traccia del trauma diventano motore di cambiamento. Qui la verità emerge in frammenti, disarticolata, e invita a guardare oltre i vincoli convenzionali per trovare nuovi slanci di resilienza.`;
        }
      } else {
        narrative = `Il suo spirito si muove tra mondi diversi, oscillando tra lo specchio dell’identità e i segni del racconto simbolico, fino alle forze sotterranee dell’ignoto. È un’esperienza molteplice che trasforma ogni sfida in un’opera drammatica, in cui il profilo si svela come trama polifonica.`;
      }

      const p = document.createElement('p');
      p.textContent = narrative;
      resDiv.appendChild(p);

      const detail = document.createElement('p');
      detail.textContent = 'Un intreccio di desiderio, mancanza e parola che riflette le tensioni nascoste in ogni organizzazione.';
      resDiv.appendChild(detail);

      // Istogramma
      const canvas = document.createElement('canvas');
      canvas.id = 'histogram';
      resDiv.appendChild(canvas);

      // Griglia frequenze
      const table = document.createElement('table');
      table.id = 'frequency-grid';
      table.innerHTML = `
        <thead>
          <tr><th>Risposta</th><th>Frequenza</th><th>Percentuale</th></tr>
        </thead>
        <tbody>
          <tr><td>A</td><td>${counts.A}</td><td>${((counts.A/total)*100).toFixed(1)}%</td></tr>
          <tr><td>B</td><td>${counts.B}</td><td>${((counts.B/total)*100).toFixed(1)}%</td></tr>
          <tr><td>C</td><td>${counts.C}</td><td>${((counts.C/total)*100).toFixed(1)}%</td></tr>
        </tbody>
      `;
      resDiv.appendChild(table);

      quiz.appendChild(resDiv);

      const ctx = document.getElementById('histogram').getContext('2d');
      new Chart(ctx, {
        type: 'bar',
        data: {
          labels: ['A','B','C'],
          datasets: [{
            data: [counts.A, counts.B, counts.C],
            backgroundColor: [
              'var(--hist-a)',
              'var(--hist-b)',
              'var(--hist-c)'
            ]
          }]
        },
        options: {
          scales: { y: { beginAtZero: true, stepSize: 1 } },
          plugins: { legend: { display: false } }
        }
      });
    }

    document.addEventListener('DOMContentLoaded', renderQuestion);
  </script>
</body>
</html>
