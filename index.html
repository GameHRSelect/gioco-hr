from zipfile import ZipFile
from pathlib import Path

# HTML aggiornato con layout diviso in due colonne: sinistra per immagine, destra per test
html_code = '''
<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Scenario HR Avanzato</title>
  <style>
    * {
      box-sizing: border-box;
    }
    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background: #F1E5D7;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      color: #06283F;
    }
    .wrapper {
      display: flex;
      width: 90%;
      max-width: 1200px;
      height: 90vh;
      background: white;
      box-shadow: 0 8px 30px rgba(0,0,0,0.15);
      border-radius: 16px;
      overflow: hidden;
    }
    .left {
      width: 50%;
      background-size: cover;
      background-position: center;
      transition: background-image 0.5s ease-in-out;
    }
    .right {
      width: 50%;
      padding: 40px;
      display: flex;
      flex-direction: column;
      justify-content: center;
      text-align: left;
    }
    h1 {
      color: #8D064A;
      font-size: 2rem;
      margin-bottom: 20px;
    }
    .question {
      font-size: 1.2rem;
      margin-bottom: 25px;
    }
    .options button {
      display: block;
      width: 100%;
      padding: 12px 16px;
      margin-bottom: 10px;
      font-size: 1rem;
      background: #1B65A5;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      transition: background 0.3s;
    }
    .options button:hover {
      background: #06283F;
    }
    .result-card {
      background: #fff;
      border-left: 5px solid #D80D32;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 0 10px rgba(0,0,0,0.05);
    }
    .result-card h2 {
      color: #D80D32;
      margin: 0 0 10px 0;
    }
    .result-card p {
      margin: 0;
    }
    .btn-reset {
      margin-top: 30px;
      background: #8D064A;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 8px;
      font-size: 1rem;
      cursor: pointer;
    }
    .btn-reset:hover {
      background: #D80D32;
    }
  </style>
</head>
<body>
  <div class="wrapper">
    <div class="left" id="left-pane"></div>
    <div class="right">
      <h1>Scenario HR Avanzato</h1>
      <div id="step" class="question"></div>
      <div class="options" id="options"></div>
      <div id="result" class="result-card" style="display:none;"></div>
      <button id="reset" class="btn-reset" style="display:none;">Rigioca</button>
    </div>
  </div>

  <script>
    const steps = [
      {
        bg: "https://images.unsplash.com/photo-1521737604893-d14cc237f11d",
        question: "Devi scegliere il leader per un progetto strategico ad alta pressione:",
        options: [
          { text: "Giovane innovatore senza esperienza manageriale", score: 3, next: 1 },
          { text: "Manager esperto ma tradizionalista", score: 1, next: 1 },
          { text: "Talento emergente con leadership naturale", score: 2, next: 1 }
        ]
      },
      {
        bg: "https://images.unsplash.com/photo-1551836022-d5d88e9218df",
        question: "Qual è la strategia che imposteresti?",
        options: [
          { text: "Innovazione e rischio calcolato", score: 3, next: 2 },
          { text: "Approccio conservativo e sicuro", score: 1, next: 2 },
          { text: "Aggressivo e orientato alla velocità", score: 2, next: 2 }
        ]
      },
      {
        bg: "https://images.unsplash.com/photo-1504384308090-c894fdcc538d",
        question: "Si verifica una crisi improvvisa: il team è spaccato. Cosa fai?",
        options: [
          { text: "Mediazione soft e rafforzamento del morale", score: 1, next: null },
          { text: "Cambio immediato del leader", score: 2, next: null },
          { text: "Ristrutturazione totale e pivot del progetto", score: 3, next: null }
        ]
      }
    ];

    const profiles = [
      { range: [0,3], title: "HR Prudente", text: "Privilegi la stabilità e riduci al minimo i rischi." },
      { range: [4,5], title: "HR Bilanciato", text: "Sai unire sicurezza e innovazione con giudizio." },
      { range: [6,7], title: "HR Visionario", text: "Spingi verso il cambiamento con decisione e coraggio." },
      { range: [8,9], title: "HR Disruptive", text: "Rivoluzioni ogni schema e accetti rischi elevati." }
    ];

    let currentStep = 0;
    let score = 0;

    const stepEl = document.getElementById('step');
    const optionsEl = document.getElementById('options');
    const resultEl = document.getElementById('result');
    const resetBtn = document.getElementById('reset');
    const leftPane = document.getElementById('left-pane');

    function updateBackground(url) {
      leftPane.style.backgroundImage = `url('${url}')`;
    }

    function showStep(index) {
      updateBackground(steps[index].bg);
      stepEl.textContent = steps[index].question;
      optionsEl.innerHTML = '';
      resultEl.style.display = 'none';
      steps[index].options.forEach(opt => {
        const btn = document.createElement('button');
        btn.textContent = opt.text;
        btn.onclick = () => {
          score += opt.score;
          if (opt.next !== null) {
            currentStep = opt.next;
            showStep(currentStep);
          } else {
            showResult();
          }
        };
        optionsEl.appendChild(btn);
      });
    }

    function showResult() {
      const profile = profiles.find(p => score >= p.range[0] && score <= p.range[1]);
      stepEl.textContent = '';
      optionsEl.innerHTML = '';
      resultEl.innerHTML = `<h2>${profile.title}</h2><p>${profile.text}</p>`;
      resultEl.style.display = 'block';
      resetBtn.style.display = 'inline-block';
    }

    resetBtn.onclick = () => {
      currentStep = 0;
      score = 0;
      resetBtn.style.display = 'none';
      showStep(currentStep);
    };

    // init
    showStep(currentStep);
  </script>
</body>
</html>
'''

# Scriviamo il file HTML in una cartella temporanea
output_dir = Path("/mnt/data/hr_game_final")
output_dir.mkdir(parents=True, exist_ok=True)
index_file = output_dir / "index.html"
index_file.write_text(html_code, encoding="utf-8")

# Comprimi tutto in uno ZIP
zip_path = Path("/mnt/data/hr_game_final.zip")
with ZipFile(zip_path, "w") as zipf:
    zipf.write(index_file, arcname="index.html")

zip_path.name  # Nome del file ZIP generato per il download

